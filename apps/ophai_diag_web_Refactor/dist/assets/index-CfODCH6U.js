import{q as Ge,s as K,t as C,v as G,d as N,x as q,c as F,y as Xe,z as Pe,A as Je,B as Te,C as Ie,D as Re,F as X,e as S,o as f,G as $,b as h,u as e,f as m,n as M,H as U,I as j,a as R,j as _,r as W,E as V,J as me,K as Ye,L as ee,M as re,N as ue,O as ce,U as de,P as Qe,Q as x,R as Ze,S as xe,V as et,W as J,X as A,Y as tt,Z as se,$ as Ue,a0 as Ne,a1 as ge,i as b,a2 as at,a3 as z,a4 as st,a5 as ye,a6 as ne,a7 as Be,a8 as De,a9 as D,aa as pe,ab as nt,ac as Ve,ad as Oe,l as ot,ae as lt,af as it,ag as rt,ah as ut,ai as fe,aj as he,ak as ct,al as dt,am as pt,an as ft,ao as vt,ap as mt,aq as be,ar as _e,as as gt,at as yt,au as ht,w as te,av as bt,aw as ae,ax as _t,ay as kt,az as wt,aA as $t,aB as St,aC as Ct,m as Y,aD as ke,aE as Et,aF as Lt,aG as we,aH as Ft,T as Pt}from"./index-BAZJoe5d.js";import{E as Ae}from"./image-viewer-Czc84juM.js";import"./index-BRRzjeIA.js";var Tt=1,It=4;function $e(t){return Ge(t,Tt|It)}const Rt=K({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:t=>t>=0&&t<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:C(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:C([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:C(Function),default:t=>`${t}%`}}),Ut=N({name:"ElProgress"}),Nt=N({...Ut,props:Rt,setup(t){const l=t,a={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},s=q("progress"),i=F(()=>{const u={width:`${l.percentage}%`,animationDuration:`${l.duration}s`},L=I(l.percentage);return L.includes("gradient")?u.background=L:u.backgroundColor=L,u}),p=F(()=>(l.strokeWidth/l.width*100).toFixed(1)),r=F(()=>["circle","dashboard"].includes(l.type)?Number.parseInt(`${50-Number.parseFloat(p.value)/2}`,10):0),E=F(()=>{const u=r.value,L=l.type==="dashboard";return`
          M 50 50
          m 0 ${L?"":"-"}${u}
          a ${u} ${u} 0 1 1 0 ${L?"-":""}${u*2}
          a ${u} ${u} 0 1 1 0 ${L?"":"-"}${u*2}
          `}),y=F(()=>2*Math.PI*r.value),P=F(()=>l.type==="dashboard"?.75:1),T=F(()=>`${-1*y.value*(1-P.value)/2}px`),k=F(()=>({strokeDasharray:`${y.value*P.value}px, ${y.value}px`,strokeDashoffset:T.value})),B=F(()=>({strokeDasharray:`${y.value*P.value*(l.percentage/100)}px, ${y.value}px`,strokeDashoffset:T.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),n=F(()=>{let u;return l.color?u=I(l.percentage):u=a[l.status]||a.default,u}),v=F(()=>l.status==="warning"?Xe:l.type==="line"?l.status==="success"?Pe:Je:l.status==="success"?Te:Ie),o=F(()=>l.type==="line"?12+l.strokeWidth*.4:l.width*.111111+2),g=F(()=>l.format(l.percentage));function c(u){const L=100/u.length;return u.map((w,O)=>X(w)?{color:w,percentage:(O+1)*L}:w).sort((w,O)=>w.percentage-O.percentage)}const I=u=>{var L;const{color:d}=l;if(Re(d))return d(u);if(X(d))return d;{const w=c(d);for(const O of w)if(O.percentage>u)return O.color;return(L=w[w.length-1])==null?void 0:L.color}};return(u,L)=>(f(),S("div",{class:h([e(s).b(),e(s).m(u.type),e(s).is(u.status),{[e(s).m("without-text")]:!u.showText,[e(s).m("text-inside")]:u.textInside}]),role:"progressbar","aria-valuenow":u.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[u.type==="line"?(f(),S("div",{key:0,class:h(e(s).b("bar"))},[m("div",{class:h(e(s).be("bar","outer")),style:M({height:`${u.strokeWidth}px`})},[m("div",{class:h([e(s).be("bar","inner"),{[e(s).bem("bar","inner","indeterminate")]:u.indeterminate},{[e(s).bem("bar","inner","striped")]:u.striped},{[e(s).bem("bar","inner","striped-flow")]:u.stripedFlow}]),style:M(e(i))},[(u.showText||u.$slots.default)&&u.textInside?(f(),S("div",{key:0,class:h(e(s).be("bar","innerText"))},[U(u.$slots,"default",{percentage:u.percentage},()=>[m("span",null,j(e(g)),1)])],2)):$("v-if",!0)],6)],6)],2)):(f(),S("div",{key:1,class:h(e(s).b("circle")),style:M({height:`${u.width}px`,width:`${u.width}px`})},[(f(),S("svg",{viewBox:"0 0 100 100"},[m("path",{class:h(e(s).be("circle","track")),d:e(E),stroke:`var(${e(s).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":u.strokeLinecap,"stroke-width":e(p),fill:"none",style:M(e(k))},null,14,["d","stroke","stroke-linecap","stroke-width"]),m("path",{class:h(e(s).be("circle","path")),d:e(E),stroke:e(n),fill:"none",opacity:u.percentage?1:0,"stroke-linecap":u.strokeLinecap,"stroke-width":e(p),style:M(e(B))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(u.showText||u.$slots.default)&&!u.textInside?(f(),S("div",{key:2,class:h(e(s).e("text")),style:M({fontSize:`${e(o)}px`})},[U(u.$slots,"default",{percentage:u.percentage},()=>[u.status?(f(),R(e(V),{key:1},{default:_(()=>[(f(),R(W(e(v))))]),_:1})):(f(),S("span",{key:0},j(e(g)),1))])],6)):$("v-if",!0)],10,["aria-valuenow"]))}});var Bt=G(Nt,[["__file","progress.vue"]]);const Dt=me(Bt),Vt=t=>["",...Ye].includes(t),Ot=K({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:Vt},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:x},activeActionIcon:{type:x},activeIcon:{type:x},inactiveIcon:{type:x},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:C(Function)},id:String,tabindex:{type:[String,Number]},...Qe(["ariaLabel"])}),At={[de]:t=>ee(t)||X(t)||re(t),[ce]:t=>ee(t)||X(t)||re(t),[ue]:t=>ee(t)||X(t)||re(t)},je="ElSwitch",jt=N({name:je}),Mt=N({...jt,props:Ot,emits:At,setup(t,{expose:l,emit:a}){const s=t,{formItem:i}=Ze(),p=xe(),r=q("switch"),{inputId:E}=et(s,{formItemContext:i}),y=J(F(()=>s.loading)),P=A(s.modelValue!==!1),T=A(),k=A(),B=F(()=>[r.b(),r.m(p.value),r.is("disabled",y.value),r.is("checked",c.value)]),n=F(()=>[r.e("label"),r.em("label","left"),r.is("active",!c.value)]),v=F(()=>[r.e("label"),r.em("label","right"),r.is("active",c.value)]),o=F(()=>({width:tt(s.width)}));se(()=>s.modelValue,()=>{P.value=!0});const g=F(()=>P.value?s.modelValue:!1),c=F(()=>g.value===s.activeValue);[s.activeValue,s.inactiveValue].includes(g.value)||(a(de,s.inactiveValue),a(ce,s.inactiveValue),a(ue,s.inactiveValue)),se(c,d=>{var w;T.value.checked=d,s.validateEvent&&((w=i==null?void 0:i.validate)==null||w.call(i,"change").catch(O=>Ue()))});const I=()=>{const d=c.value?s.inactiveValue:s.activeValue;a(de,d),a(ce,d),a(ue,d),st(()=>{T.value.checked=c.value})},u=()=>{if(y.value)return;const{beforeChange:d}=s;if(!d){I();return}const w=d();[ye(w),ee(w)].includes(!0)||ne(je,"beforeChange must return type `Promise<boolean>` or `boolean`"),ye(w)?w.then(Z=>{Z&&I()}).catch(Z=>{}):w&&I()},L=()=>{var d,w;(w=(d=T.value)==null?void 0:d.focus)==null||w.call(d)};return Ne(()=>{T.value.checked=c.value}),l({focus:L,checked:c}),(d,w)=>(f(),S("div",{class:h(e(B)),onClick:z(u,["prevent"])},[m("input",{id:e(E),ref_key:"input",ref:T,class:h(e(r).e("input")),type:"checkbox",role:"switch","aria-checked":e(c),"aria-disabled":e(y),"aria-label":d.ariaLabel,name:d.name,"true-value":d.activeValue,"false-value":d.inactiveValue,disabled:e(y),tabindex:d.tabindex,onChange:I,onKeydown:ge(u,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!d.inlinePrompt&&(d.inactiveIcon||d.inactiveText)?(f(),S("span",{key:0,class:h(e(n))},[d.inactiveIcon?(f(),R(e(V),{key:0},{default:_(()=>[(f(),R(W(d.inactiveIcon)))]),_:1})):$("v-if",!0),!d.inactiveIcon&&d.inactiveText?(f(),S("span",{key:1,"aria-hidden":e(c)},j(d.inactiveText),9,["aria-hidden"])):$("v-if",!0)],2)):$("v-if",!0),m("span",{ref_key:"core",ref:k,class:h(e(r).e("core")),style:M(e(o))},[d.inlinePrompt?(f(),S("div",{key:0,class:h(e(r).e("inner"))},[d.activeIcon||d.inactiveIcon?(f(),R(e(V),{key:0,class:h(e(r).is("icon"))},{default:_(()=>[(f(),R(W(e(c)?d.activeIcon:d.inactiveIcon)))]),_:1},8,["class"])):d.activeText||d.inactiveText?(f(),S("span",{key:1,class:h(e(r).is("text")),"aria-hidden":!e(c)},j(e(c)?d.activeText:d.inactiveText),11,["aria-hidden"])):$("v-if",!0)],2)):$("v-if",!0),m("div",{class:h(e(r).e("action"))},[d.loading?(f(),R(e(V),{key:0,class:h(e(r).is("loading"))},{default:_(()=>[b(e(at))]),_:1},8,["class"])):e(c)?U(d.$slots,"active-action",{key:1},()=>[d.activeActionIcon?(f(),R(e(V),{key:0},{default:_(()=>[(f(),R(W(d.activeActionIcon)))]),_:1})):$("v-if",!0)]):e(c)?$("v-if",!0):U(d.$slots,"inactive-action",{key:2},()=>[d.inactiveActionIcon?(f(),R(e(V),{key:0},{default:_(()=>[(f(),R(W(d.inactiveActionIcon)))]),_:1})):$("v-if",!0)])],2)],6),!d.inlinePrompt&&(d.activeIcon||d.activeText)?(f(),S("span",{key:1,class:h(e(v))},[d.activeIcon?(f(),R(e(V),{key:0},{default:_(()=>[(f(),R(W(d.activeIcon)))]),_:1})):$("v-if",!0),!d.activeIcon&&d.activeText?(f(),S("span",{key:1,"aria-hidden":!e(c)},j(d.activeText),9,["aria-hidden"])):$("v-if",!0)],2)):$("v-if",!0)],10,["onClick"]))}});var qt=G(Mt,[["__file","switch.vue"]]);const zt=me(qt),Me=Symbol("uploadContextKey"),Kt="ElUpload";class Ht extends Error{constructor(l,a,s,i){super(l),this.name="UploadAjaxError",this.status=a,this.method=s,this.url=i}}function Se(t,l,a){let s;return a.response?s=`${a.response.error||a.response}`:a.responseText?s=`${a.responseText}`:s=`fail to ${l.method} ${t} ${a.status}`,new Ht(s,a.status,l.method,t)}function Wt(t){const l=t.responseText||t.response;if(!l)return l;try{return JSON.parse(l)}catch{return l}}const Gt=t=>{typeof XMLHttpRequest>"u"&&ne(Kt,"XMLHttpRequest is undefined");const l=new XMLHttpRequest,a=t.action;l.upload&&l.upload.addEventListener("progress",p=>{const r=p;r.percent=p.total>0?p.loaded/p.total*100:0,t.onProgress(r)});const s=new FormData;if(t.data)for(const[p,r]of Object.entries(t.data))Be(r)&&r.length?s.append(p,...r):s.append(p,r);s.append(t.filename,t.file,t.file.name),l.addEventListener("error",()=>{t.onError(Se(a,t,l))}),l.addEventListener("load",()=>{if(l.status<200||l.status>=300)return t.onError(Se(a,t,l));t.onSuccess(Wt(l))}),l.open(t.method,a,!0),t.withCredentials&&"withCredentials"in l&&(l.withCredentials=!0);const i=t.headers||{};if(i instanceof Headers)i.forEach((p,r)=>l.setRequestHeader(r,p));else for(const[p,r]of Object.entries(i))De(r)||l.setRequestHeader(p,String(r));return l.send(s),l},qe=["text","picture","picture-card"];let Xt=1;const ve=()=>Date.now()+Xt++,ze=K({action:{type:String,default:"#"},headers:{type:C(Object)},method:{type:String,default:"post"},data:{type:C([Object,Function,Promise]),default:()=>pe({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:C(Array),default:()=>pe([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:qe,default:"text"},httpRequest:{type:C(Function),default:Gt},disabled:Boolean,limit:Number}),Jt=K({...ze,beforeUpload:{type:C(Function),default:D},beforeRemove:{type:C(Function)},onRemove:{type:C(Function),default:D},onChange:{type:C(Function),default:D},onPreview:{type:C(Function),default:D},onSuccess:{type:C(Function),default:D},onProgress:{type:C(Function),default:D},onError:{type:C(Function),default:D},onExceed:{type:C(Function),default:D},crossorigin:{type:C(String)}}),Yt=K({files:{type:C(Array),default:()=>pe([])},disabled:{type:Boolean,default:!1},handlePreview:{type:C(Function),default:D},listType:{type:String,values:qe,default:"text"},crossorigin:{type:C(String)}}),Qt={remove:t=>!!t},Zt=N({name:"ElUploadList"}),xt=N({...Zt,props:Yt,emits:Qt,setup(t,{emit:l}){const a=t,{t:s}=nt(),i=q("upload"),p=q("icon"),r=q("list"),E=J(),y=A(!1),P=F(()=>[i.b("list"),i.bm("list",a.listType),i.is("disabled",a.disabled)]),T=k=>{l("remove",k)};return(k,B)=>(f(),R(rt,{tag:"ul",class:h(e(P)),name:e(r).b()},{default:_(()=>[(f(!0),S(Ve,null,Oe(k.files,(n,v)=>(f(),S("li",{key:n.uid||n.name,class:h([e(i).be("list","item"),e(i).is(n.status),{focusing:y.value}]),tabindex:"0",onKeydown:ge(o=>!e(E)&&T(n),["delete"]),onFocus:o=>y.value=!0,onBlur:o=>y.value=!1,onClick:o=>y.value=!1},[U(k.$slots,"default",{file:n,index:v},()=>[k.listType==="picture"||n.status!=="uploading"&&k.listType==="picture-card"?(f(),S("img",{key:0,class:h(e(i).be("list","item-thumbnail")),src:n.url,crossorigin:k.crossorigin,alt:""},null,10,["src","crossorigin"])):$("v-if",!0),n.status==="uploading"||k.listType!=="picture-card"?(f(),S("div",{key:1,class:h(e(i).be("list","item-info"))},[m("a",{class:h(e(i).be("list","item-name")),onClick:z(o=>k.handlePreview(n),["prevent"])},[b(e(V),{class:h(e(p).m("document"))},{default:_(()=>[b(e(ot))]),_:1},8,["class"]),m("span",{class:h(e(i).be("list","item-file-name")),title:n.name},j(n.name),11,["title"])],10,["onClick"]),n.status==="uploading"?(f(),R(e(Dt),{key:0,type:k.listType==="picture-card"?"circle":"line","stroke-width":k.listType==="picture-card"?6:2,percentage:Number(n.percentage),style:M(k.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):$("v-if",!0)],2)):$("v-if",!0),m("label",{class:h(e(i).be("list","item-status-label"))},[k.listType==="text"?(f(),R(e(V),{key:0,class:h([e(p).m("upload-success"),e(p).m("circle-check")])},{default:_(()=>[b(e(Pe))]),_:1},8,["class"])):["picture-card","picture"].includes(k.listType)?(f(),R(e(V),{key:1,class:h([e(p).m("upload-success"),e(p).m("check")])},{default:_(()=>[b(e(Te))]),_:1},8,["class"])):$("v-if",!0)],2),e(E)?$("v-if",!0):(f(),R(e(V),{key:2,class:h(e(p).m("close")),onClick:o=>T(n)},{default:_(()=>[b(e(Ie))]),_:2},1032,["class","onClick"])),$(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),$(" This is a bug which needs to be fixed "),$(" TODO: Fix the incorrect navigation interaction "),e(E)?$("v-if",!0):(f(),S("i",{key:3,class:h(e(p).m("close-tip"))},j(e(s)("el.upload.deleteTip")),3)),k.listType==="picture-card"?(f(),S("span",{key:4,class:h(e(i).be("list","item-actions"))},[m("span",{class:h(e(i).be("list","item-preview")),onClick:o=>k.handlePreview(n)},[b(e(V),{class:h(e(p).m("zoom-in"))},{default:_(()=>[b(e(lt))]),_:1},8,["class"])],10,["onClick"]),e(E)?$("v-if",!0):(f(),S("span",{key:0,class:h(e(i).be("list","item-delete")),onClick:o=>T(n)},[b(e(V),{class:h(e(p).m("delete"))},{default:_(()=>[b(e(it))]),_:1},8,["class"])],10,["onClick"]))],2)):$("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),U(k.$slots,"append")]),_:3},8,["class","name"]))}});var Ce=G(xt,[["__file","upload-list.vue"]]);const ea=K({disabled:{type:Boolean,default:!1}}),ta={file:t=>Be(t)},Ke="ElUploadDrag",aa=N({name:Ke}),sa=N({...aa,props:ea,emits:ta,setup(t,{emit:l}){ut(Me)||ne(Ke,"usage: <el-upload><el-upload-dragger /></el-upload>");const s=q("upload"),i=A(!1),p=J(),r=y=>{if(p.value)return;i.value=!1,y.stopPropagation();const P=Array.from(y.dataTransfer.files),T=y.dataTransfer.items||[];P.forEach((k,B)=>{var n;const v=T[B],o=(n=v==null?void 0:v.webkitGetAsEntry)==null?void 0:n.call(v);o&&(k.isDirectory=o.isDirectory)}),l("file",P)},E=()=>{p.value||(i.value=!0)};return(y,P)=>(f(),S("div",{class:h([e(s).b("dragger"),e(s).is("dragover",i.value)]),onDrop:z(r,["prevent"]),onDragover:z(E,["prevent"]),onDragleave:z(T=>i.value=!1,["prevent"])},[U(y.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var na=G(sa,[["__file","upload-dragger.vue"]]);const oa=K({...ze,beforeUpload:{type:C(Function),default:D},onRemove:{type:C(Function),default:D},onStart:{type:C(Function),default:D},onSuccess:{type:C(Function),default:D},onProgress:{type:C(Function),default:D},onError:{type:C(Function),default:D},onExceed:{type:C(Function),default:D}}),la=N({name:"ElUploadContent",inheritAttrs:!1}),ia=N({...la,props:oa,setup(t,{expose:l}){const a=t,s=q("upload"),i=J(),p=fe({}),r=fe(),E=o=>{if(o.length===0)return;const{autoUpload:g,limit:c,fileList:I,multiple:u,onStart:L,onExceed:d}=a;if(c&&I.length+o.length>c){d(o,I);return}u||(o=o.slice(0,1));for(const w of o){const O=w;O.uid=ve(),L(O),g&&y(O)}},y=async o=>{if(r.value.value="",!a.beforeUpload)return T(o);let g,c={};try{const u=a.data,L=a.beforeUpload(o);c=he(a.data)?$e(a.data):a.data,g=await L,he(a.data)&&ct(u,c)&&(c=$e(a.data))}catch{g=!1}if(g===!1){a.onRemove(o);return}let I=o;g instanceof Blob&&(g instanceof File?I=g:I=new File([g],o.name,{type:o.type})),T(Object.assign(I,{uid:o.uid}),c)},P=async(o,g)=>Re(o)?o(g):o,T=async(o,g)=>{const{headers:c,data:I,method:u,withCredentials:L,name:d,action:w,onProgress:O,onSuccess:Z,onError:He,httpRequest:We}=a;try{g=await P(g??I,o)}catch{a.onRemove(o);return}const{uid:oe}=o,le={headers:c||{},withCredentials:L,file:o,data:g,method:u,filename:d,action:w,onProgress:H=>{O(H,o)},onSuccess:H=>{Z(H,o),delete p.value[oe]},onError:H=>{He(H,o),delete p.value[oe]}},ie=We(le);p.value[oe]=ie,ie instanceof Promise&&ie.then(le.onSuccess,le.onError)},k=o=>{const g=o.target.files;g&&E(Array.from(g))},B=()=>{i.value||(r.value.value="",r.value.click())},n=()=>{B()};return l({abort:o=>{dt(p.value).filter(o?([c])=>String(o.uid)===c:()=>!0).forEach(([c,I])=>{I instanceof XMLHttpRequest&&I.abort(),delete p.value[c]})},upload:y}),(o,g)=>(f(),S("div",{class:h([e(s).b(),e(s).m(o.listType),e(s).is("drag",o.drag),e(s).is("disabled",e(i))]),tabindex:e(i)?"-1":"0",onClick:B,onKeydown:ge(z(n,["self"]),["enter","space"])},[o.drag?(f(),R(na,{key:0,disabled:e(i),onFile:E},{default:_(()=>[U(o.$slots,"default")]),_:3},8,["disabled"])):U(o.$slots,"default",{key:1}),m("input",{ref_key:"inputRef",ref:r,class:h(e(s).e("input")),name:o.name,disabled:e(i),multiple:o.multiple,accept:o.accept,type:"file",onChange:k,onClick:z(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var Ee=G(ia,[["__file","upload-content.vue"]]);const Le="ElUpload",Fe=t=>{var l;(l=t.url)!=null&&l.startsWith("blob:")&&URL.revokeObjectURL(t.url)},ra=(t,l)=>{const a=pt(t,"fileList",void 0,{passive:!0}),s=n=>a.value.find(v=>v.uid===n.uid);function i(n){var v;(v=l.value)==null||v.abort(n)}function p(n=["ready","uploading","success","fail"]){a.value=a.value.filter(v=>!n.includes(v.status))}function r(n){a.value=a.value.filter(v=>v.uid!==n.uid)}const E=(n,v)=>{const o=s(v);o&&(console.error(n),o.status="fail",r(o),t.onError(n,o,a.value),t.onChange(o,a.value))},y=(n,v)=>{const o=s(v);o&&(t.onProgress(n,o,a.value),o.status="uploading",o.percentage=Math.round(n.percent))},P=(n,v)=>{const o=s(v);o&&(o.status="success",o.response=n,t.onSuccess(n,o,a.value),t.onChange(o,a.value))},T=n=>{De(n.uid)&&(n.uid=ve());const v={name:n.name,percentage:0,status:"ready",size:n.size,raw:n,uid:n.uid};if(t.listType==="picture-card"||t.listType==="picture")try{v.url=URL.createObjectURL(n)}catch(o){Ue(Le,o.message),t.onError(o,v,a.value)}a.value=[...a.value,v],t.onChange(v,a.value)},k=async n=>{const v=n instanceof File?s(n):n;v||ne(Le,"file to be removed not found");const o=g=>{i(g),r(g),t.onRemove(g,a.value),Fe(g)};t.beforeRemove?await t.beforeRemove(v,a.value)!==!1&&o(v):o(v)};function B(){a.value.filter(({status:n})=>n==="ready").forEach(({raw:n})=>{var v;return n&&((v=l.value)==null?void 0:v.upload(n))})}return se(()=>t.listType,n=>{n!=="picture-card"&&n!=="picture"||(a.value=a.value.map(v=>{const{raw:o,url:g}=v;if(!g&&o)try{v.url=URL.createObjectURL(o)}catch(c){t.onError(c,v,a.value)}return v}))}),se(a,n=>{for(const v of n)v.uid||(v.uid=ve()),v.status||(v.status="success")},{immediate:!0,deep:!0}),{uploadFiles:a,abort:i,clearFiles:p,handleError:E,handleProgress:y,handleStart:T,handleSuccess:P,handleRemove:k,submit:B,revokeFileObjectURL:Fe}},ua=N({name:"ElUpload"}),ca=N({...ua,props:Jt,setup(t,{expose:l}){const a=t,s=J(),i=fe(),{abort:p,submit:r,clearFiles:E,uploadFiles:y,handleStart:P,handleError:T,handleRemove:k,handleSuccess:B,handleProgress:n,revokeFileObjectURL:v}=ra(a,i),o=F(()=>a.listType==="picture-card"),g=F(()=>({...a,fileList:y.value,onStart:P,onProgress:n,onSuccess:B,onError:T,onRemove:k}));return ft(()=>{y.value.forEach(v)}),vt(Me,{accept:mt(a,"accept")}),l({abort:p,submit:r,clearFiles:E,handleStart:P,handleRemove:k}),(c,I)=>(f(),S("div",null,[e(o)&&c.showFileList?(f(),R(Ce,{key:0,disabled:e(s),"list-type":c.listType,files:e(y),crossorigin:c.crossorigin,"handle-preview":c.onPreview,onRemove:e(k)},be({append:_(()=>[b(Ee,_e({ref_key:"uploadRef",ref:i},e(g)),{default:_(()=>[c.$slots.trigger?U(c.$slots,"trigger",{key:0}):$("v-if",!0),!c.$slots.trigger&&c.$slots.default?U(c.$slots,"default",{key:1}):$("v-if",!0)]),_:3},16)]),_:2},[c.$slots.file?{name:"default",fn:_(({file:u,index:L})=>[U(c.$slots,"file",{file:u,index:L})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):$("v-if",!0),!e(o)||e(o)&&!c.showFileList?(f(),R(Ee,_e({key:1,ref_key:"uploadRef",ref:i},e(g)),{default:_(()=>[c.$slots.trigger?U(c.$slots,"trigger",{key:0}):$("v-if",!0),!c.$slots.trigger&&c.$slots.default?U(c.$slots,"default",{key:1}):$("v-if",!0)]),_:3},16)):$("v-if",!0),c.$slots.trigger?U(c.$slots,"default",{key:2}):$("v-if",!0),U(c.$slots,"tip"),!e(o)&&c.showFileList?(f(),R(Ce,{key:3,disabled:e(s),"list-type":c.listType,files:e(y),crossorigin:c.crossorigin,"handle-preview":c.onPreview,onRemove:e(k)},be({_:2},[c.$slots.file?{name:"default",fn:_(({file:u,index:L})=>[U(c.$slots,"file",{file:u,index:L})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):$("v-if",!0)]))}});var da=G(ca,[["__file","upload.vue"]]);const pa=me(da),Q=gt("file",()=>{const t=A();return{files:t,setFiles:a=>{t.value=a}}});function fa(){const t=A({patientId:"",patientName:""});return{validateImageName:async a=>{try{for(const s of a){const i=s.raw;await yt({name:i.name.toLowerCase()},ht);const p=i.name.split("_");t.value.patientId=`${p[0]}_${p[1]}`,t.value.patientName=p[2]}return!0}catch(s){return console.error("文件验证失败:",s),!1}},userInfo:t}}function va(t){const l=Q(),a=A(!1);return{bulkUpload:a,handleModeChange:()=>{t("bulkUpload",a.value),l.setFiles([])},uploadLimit:a.value?2:void 0}}const ma={class:"fu-upload-container"},ga={class:"picture-upload-container"},ya={class:"picture-upload-container__title"},ha={class:"bulkSwitch"},ba={class:"fu-container__block patient-info-container"},_a=N({__name:"FuUpload",emits:["bulkUpload"],setup(t,{emit:l}){const a=l,s=Q(),i=A([]),{validateImageName:p,userInfo:r}=fa(),E=(B,n)=>{p(n)&&s.setFiles(n)},y=(B,n)=>{s.setFiles(n)},{bulkUpload:P,handleModeChange:T,uploadLimit:k}=va(a);return(B,n)=>{const v=zt,o=V,g=pa,c=Ct,I=St,u=$t,L=wt,d=_t;return f(),S("div",ma,[m("div",ga,[m("div",ya,[n[4]||(n[4]=m("span",null,"图片上传",-1)),m("span",ha,[b(v,{modelValue:e(P),"onUpdate:modelValue":n[0]||(n[0]=w=>bt(P)?P.value=w:null),"active-text":"批量上传",onChange:e(T)},null,8,["modelValue","onChange"])])]),b(g,{class:"picture-upload-container__upload","show-file-list":!0,"file-list":i.value,"onUpdate:fileList":n[1]||(n[1]=w=>i.value=w),limit:e(k),"on-remove":y,"on-change":E,action:"#",drag:"",multiple:"","auto-upload":!1,accept:".jpg"},{tip:_(()=>n[5]||(n[5]=[m("div",{class:"upload--tip"},"仅支持jpg格式。图片命名需要以 患者ID_患者姓名_left（或_right）来区分左右眼",-1)])),default:_(()=>[b(o,{class:"el-icon--upload"},{default:_(()=>[b(e(kt))]),_:1}),n[6]||(n[6]=m("div",{class:"upload--text"},"图片拖拽到此处或单击此处",-1))]),_:1},8,["file-list","limit"])]),te(m("div",ba,[n[7]||(n[7]=m("div",{class:"patient-info-container__title"},[m("span",null,"患者信息")],-1)),b(d,{class:"patient-info-container__form","label-position":"top","require-asterisk-position":"right"},{default:_(()=>[b(L,{gutter:10,justify:"space-between"},{default:_(()=>[b(u,{span:12},{default:_(()=>[b(I,{label:"患者ID",required:""},{default:_(()=>[b(c,{disabled:"",modelValue:e(r).patientId,"onUpdate:modelValue":n[2]||(n[2]=w=>e(r).patientId=w)},null,8,["modelValue"])]),_:1})]),_:1}),b(u,{span:12},{default:_(()=>[b(I,{label:"姓名",required:""},{default:_(()=>[b(c,{disabled:"",modelValue:e(r).patientName,"onUpdate:modelValue":n[3]||(n[3]=w=>e(r).patientName=w)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})],512),[[ae,!e(P)]])])}}}),ka=Y(_a,[["__scopeId","data-v-0fd47726"]]),wa={class:"single-upload-container",style:{"flex-direction":"row"}},$a={class:"single-upload-container__content"},Sa={class:"image-item"},Ca={class:"image-item__error"},Ea={class:"single-upload-container__content"},La={class:"image-item"},Fa={class:"image-item__error"},Pa=N({__name:"FuSinglePreview",setup(t){const l=Q(),a=F(()=>{const s=[];for(const i of l.files??[]){const p=i.raw,r=p.name;r.toLowerCase().includes("left")?s[0]=URL.createObjectURL(p):r.toLowerCase().includes("right")&&(s[1]=URL.createObjectURL(p))}return s});return(s,i)=>{const p=V,r=Ae;return f(),S("div",wa,[m("div",$a,[i[1]||(i[1]=m("div",{class:"single-upload-container__title"},[m("span",null,"左眼")],-1)),m("div",Sa,[i[0]||(i[0]=m("span",null,"原始图像",-1)),b(r,{class:"image-item__image",fit:"contain","preview-src-list":a.value,src:a.value[0]},{error:_(()=>[m("div",Ca,[b(p,{size:"1.5rem"},{default:_(()=>[b(e(ke))]),_:1})])]),_:1},8,["preview-src-list","src"])])]),m("div",Ea,[i[3]||(i[3]=m("div",{class:"single-upload-container__title"},[m("span",null,"右眼")],-1)),m("div",La,[i[2]||(i[2]=m("span",null,"原始图像",-1)),b(r,{class:"image-item__image",fit:"contain","preview-src-list":a.value,src:a.value[1]},{error:_(()=>[m("div",Fa,[b(p,{size:"1.5rem"},{default:_(()=>[b(e(ke))]),_:1})])]),_:1},8,["preview-src-list","src"])])])])}}}),Ta=Y(Pa,[["__scopeId","data-v-6b4b68b7"]]);function Ia(){const t=Q();return{bulkMap:F(()=>{const a=new Map;for(const s of t.files??[]){const i=s.raw,p=i.name,r=p.split("_"),E=`${r[0]}_${r[1]}`;if(a.has(E)){const y=a.get(E);p.toLowerCase().includes("left")?y.previewLeft=URL.createObjectURL(i):y.previewRight=URL.createObjectURL(i)}else{const y=p.toLowerCase().includes("left");a.set(E,{previewLeft:y?URL.createObjectURL(i):"",previewRight:y?"":URL.createObjectURL(i),patientId:E,patientName:r[2]})}}return a})}}const Ra={class:"bulk-upload-container"},Ua={class:"grid-item__label"},Na=N({__name:"FuBulkPreview",setup(t){const{bulkMap:l}=Ia();return(a,s)=>{const i=Ae;return f(),S("div",Ra,[(f(!0),S(Ve,null,Oe(e(l),([p,r],E)=>(f(),S("div",{class:"grid-item",key:E},[m("div",Ua,[m("label",null,"ID："+j(p),1),m("label",null,"姓名："+j(r.patientName),1)]),b(i,{class:"grid-item__image",fit:"contain",src:r.previewLeft,"preview-teleported":!0,"preview-src-list":[r.previewLeft,r.previewRight]},{error:_(()=>s[0]||(s[0]=[m("div",{class:"grid-item__error"},"左眼图片未上传",-1)])),_:2},1032,["src","preview-src-list"]),b(i,{class:"grid-item__image",fit:"contain",src:r.previewRight,"preview-teleported":!0,"preview-src-list":[r.previewLeft,r.previewRight]},{error:_(()=>s[1]||(s[1]=[m("div",{class:"grid-item__error"},"右眼图片未上传",-1)])),_:2},1032,["src","preview-src-list"])]))),128))])}}}),Ba=Y(Na,[["__scopeId","data-v-80c52e58"]]),Da=t=>Et({url:"/api/preImage/saveAndProcess",method:"post",data:t,noToken:!0,headers:{"Content-Type":"multipart/form-data"}});function Va(){const t=Q();return{handleSubmit:async()=>{var s;const a=new FormData;(s=t.files)==null||s.forEach(i=>{a.append("file",i.raw)});try{const i=await Da(a);console.log("提交成功:",i),t.setFiles([])}catch(i){console.error("提交失败:",i)}}}}const Oa={class:"fu-container__footer"},Aa=N({__name:"FuFooter",setup(t){const{handleSubmit:l}=Va();return(a,s)=>{const i=Lt;return f(),S("div",Oa,[b(i,{type:"info"},{default:_(()=>s[0]||(s[0]=[we("重置")])),_:1}),b(i,{type:"primary",onClick:e(l)},{default:_(()=>s[1]||(s[1]=[we("提交")])),_:1},8,["onClick"])])}}}),ja=Y(Aa,[["__scopeId","data-v-99464ce5"]]),Ma={class:"fu-container"},qa={class:"fu-container__main"},za={class:"fu-container__main-right"},Ka=N({__name:"index",setup(t){const l=A(!1),a=A(!1),s=i=>{l.value=i.y>window.innerHeight/1.5};return Ne(()=>document.addEventListener("mousemove",s)),Ft(()=>document.removeEventListener("mousemove",s)),(i,p)=>(f(),S("div",Ma,[m("div",qa,[b(ka,{onBulkUpload:p[0]||(p[0]=r=>{a.value=r})}),m("div",za,[te(b(Ta,null,null,512),[[ae,!a.value]]),te(b(Ba,null,null,512),[[ae,a.value]])])]),b(Pt,{name:"move--up"},{default:_(()=>[te(b(ja,null,null,512),[[ae,l.value]])]),_:1})]))}}),Xa=Y(Ka,[["__scopeId","data-v-d6da85f1"]]);export{Xa as default};
